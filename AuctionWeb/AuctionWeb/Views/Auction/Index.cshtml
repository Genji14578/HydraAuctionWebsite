@using PagedList
@using PagedList.Mvc
@model IPagedList<AuctionWeb.Models.Auction>
@{
    ViewBag.Title = "Index";

}

<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<!-- start-smoth-scrolling -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="~/Content/js/move-top.js"></script>
<script type="text/javascript" src="~/Content/js/easing.js"></script>
<script type="text/javascript">

    <script type="application/x-javascript"> addEventListener("load", function() {setTimeout(hideURLbar, 0); }, false); function hideURLbar(){window.scrollTo(0, 1); }>
</script>
<link href="~/Content/css/bootstrap.css" rel="stylesheet" type="text/css" media="all">
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="~/Content/js/jquery-1.11.0.min.js"></script>
<!-- Custom Theme files -->
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css">
<link href="~/Content/css/style.css" rel="stylesheet" type="text/css" media="all" />
<link rel="stylesheet" href="~/Content/css/flexslider.css" type="text/css" media="screen" />
<script src="~/Content/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
<script src="~/Content/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
<script src="~/Content/vendor/bootstrap/js/popper.js"></script>
<script src="~/Content/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
<script src="~/Content/vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
<script src="~/Content/vendor/daterangepicker/moment.min.js"></script>
<script src="~/Content/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
<script src="~/Content/vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
<script src="~/Content/js/main.js"></script>
<link rel="icon" type="image/png" href="~/Content/images/icons/favicon.ico" />
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/fonts/iconic/css/material-design-iconic-font.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/animate/animate.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/select2/select2.min.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
<link rel="stylesheet" type="text/css" href="~/Content/css/util.css">
<link rel="stylesheet" type="text/css" href="~/Content/css/main.css">
<script src="~/Content/js/responsiveslides.min.js"></script>
<script>
                        $(function () {
                $("#slider").responsiveSlides({
                    auto: true,
                    speed: 500,
                    namespace: "callbacks",
                    pager: false,
                    nav: true,
                });
            });

</script>
<script>



    function test(){
            function getAuctionsDetail() {

                $.ajax({
                    type: "GET",
                    url: "@Url.Action("getAuctionDetail", "Auction")",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {




                        // Parse the object

                        var obj = JSON.parse(result);
                        //

                        var now = new Date();


                        var listAucs = Object.values(obj);
                        for (var i = 0; i < listAucs.length; i++) {

                            var endTime = new Date(listAucs[i].auction_end_date);
                            console.log(i + " " + "endTime : " + Date.parse(endTime) + " now : " + (Date.parse(now)+1000));
                            if (Date.parse(endTime) === (Date.parse(now)+1000)) {
                                location.replace("http://localhost:51112/Bill/CreateBill?idBuyer=" + listAucs[i].id_buyer_account
                                    + "&idAuc=" + listAucs[i].id + "&finalBid=" + listAucs[i].auction_bid_increment
                                );
                            }
                        }


                    },
                    error: function (response) {

                        alert('error');
                    }
                });



            }
           var q=setInterval(function() {getAuctionsDetail(); }, 1000);

        }












</script>
<body onload="test()">
    <div class="services">
        <div class="container">
            <div class="services-main">
                <div class="services-top">
                    <h3>Our Best Services</h3>
                    <p>Great design is about more than style,it,s about being yoursel</p>
                    @if (User.Identity.IsAuthenticated)
                    {
                        <a href="@Url.Action("Sell", "Auction")" style="color:red">Sell An Item</a>
                    }
                </div>
                <div class="services-bottom">
                    <div class="row">
                        @foreach (var item in Model)
                        {
                            <div class="col-sm-6 col-md-4 ser">


                                <div class="thumbnail" style="padding-bottom:10px;opacity:1">
                                    <a href="~/Auction/Detail?id=@item.id"><img src="~/Content/images/@item.auction_image" alt=""></a>
                                    <div class="caption">
                                        <h1 style="text-align:center">@item.Category.category_name</h1>
                                        <a href="~/Auction/Detail?id=@item.id" style="text-align:center"> <h3 id="aucName">@item.auction_name</h3></a>
                                        <p>@item.auction_description</p>
                                        <p id="aucBidInc">Present Price : @item.auction_bid_increment</p>
                                        <p>End Time :<span id="endtime">@item.auction_end_date</span></p>
                                    </div>


                                </div>

                            </div>


                        }
                        <div class="clearfix"></div><br>


                    </div>
                    Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
                    @Html.PagedListPager(Model, page => Url.Action("Index", new { page }))
                </div>
            </div>
        </div>
    </div>
</body>